import{r as g,j as e,_ as a,u as D}from"./index-Bj_GjLxz.js";import{L as N,h as C,o as T,a as $}from"./language-BoBOnVyv.js";import{MarkdownContent as A}from"./MarkdownContent-B05vROgH.js";function S({src:s,alt:c,caption:_,design:u}){const[x,l]=g.useState(!1),[h,m]=g.useState(!0),n=`/cracking-interview/assets/img/design/${u}/${s}`,i=()=>{m(!1)},d=()=>{l(!0),m(!1)};return x?e.jsxs("div",{className:"my-6 p-4 border border-destructive/20 rounded-lg bg-destructive/5",children:[e.jsxs("p",{className:"text-destructive text-sm",children:["Failed to load image: ",e.jsx("code",{className:"bg-destructive/10 px-1 rounded",children:s})]}),e.jsxs("p",{className:"text-muted-foreground text-xs mt-1",children:["Expected path: ",e.jsx("code",{className:"bg-muted px-1 rounded",children:n})]})]}):e.jsxs("figure",{className:"my-8",children:[e.jsxs("div",{className:"relative",children:[h&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-muted/20 rounded-lg",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}),e.jsx("img",{src:n,alt:c,className:"max-w-full h-auto rounded-lg border border-border shadow-sm mx-auto",onLoad:i,onError:d})]}),_&&e.jsx("figcaption",{className:"text-center text-sm text-muted-foreground mt-2 italic",children:_})]})}const I={"library-management":{"accounts.java":()=>a(()=>import("./accounts-BPsuStyL.js"),[]),"accounts.py":()=>a(()=>import("./accounts-CaADFPGk.js"),[]),"book.java":()=>a(()=>import("./book-B7Nl5EAy.js"),[]),"book.py":()=>a(()=>import("./book-D3kpjQqS.js"),[]),"enums.java":()=>a(()=>import("./enums-ZUwC1wbB.js"),[]),"enums.py":()=>a(()=>import("./enums-OzGca87i.js"),[]),"reservation.java":()=>a(()=>import("./reservation-DpvNMo44.js"),[]),"reservation.py":()=>a(()=>import("./reservation-1yUQxuyD.js"),[]),"search.java":()=>a(()=>import("./search-CcJY8_QS.js"),[]),"search.py":()=>a(()=>import("./search-Dm3RLGci.js"),[])},"parking-lot":{"accounts.java":()=>a(()=>import("./accounts-CSRvGaf-.js"),[]),"accounts.py":()=>a(()=>import("./accounts-DOkrZ5j-.js"),[]),"enums.java":()=>a(()=>import("./enums-KmoOhoq5.js"),[]),"enums.py":()=>a(()=>import("./enums-B3zgpcgA.js"),[]),"parkingDisplay.java":()=>a(()=>import("./parkingDisplay-MzJTd5Sf.js"),[]),"parkingDisplay.py":()=>a(()=>import("./parkingDisplay-CsHxv9TI.js"),[]),"parkingFloor.java":()=>a(()=>import("./parkingFloor-DML4PQMs.js"),[]),"parkingFloor.py":()=>a(()=>import("./parkingFloor-C53_vuuA.js"),[]),"parkingLot.java":()=>a(()=>import("./parkingLot-BmSNbdHO.js"),[]),"parkingLot.py":()=>a(()=>import("./parkingLot-Cv-g0gL-.js"),[]),"parkingSpot.java":()=>a(()=>import("./parkingSpot-h8zkjBnu.js"),[]),"parkingSpot.py":()=>a(()=>import("./parkingSpot-CktN2HGY.js"),[]),"vehicle.java":()=>a(()=>import("./vehicle-BUzy1JjJ.js"),[]),"vehicle.py":()=>a(()=>import("./vehicle-Cas_-IVT.js"),[])}},w=new Map;async function P(s){var x;console.log(`Loading code for design: ${s}`);const c=s;if(w.has(c))return console.log(`Returning cached code for: ${s}`),w.get(c);const _=I[s];if(!_)return console.log(`No code files found for design: ${s}`),null;const u={};try{for(const[l,h]of Object.entries(_))try{const m=await h(),n=((x=l.split(".").pop())==null?void 0:x.toLowerCase())||"";u[l]={language:n,code:m.default||"",path:`src/content/system-design/code/${s}/${l}`},console.log(`Loaded code file: ${l}`)}catch(m){console.warn(`Failed to load code file ${l}:`,m)}return console.log(`Successfully loaded ${Object.keys(u).length} code files for ${s}`),w.set(c,u),Object.keys(u).length>0?u:null}catch(l){return console.error(`Failed to load code for design ${s}:`,l),null}}function R({file:s,design:c,title:_,description:u}){var o;const[x,l]=g.useState(""),[h,m]=g.useState(!0),[n,i]=g.useState(null),{theme:d}=D(),p=((o=s.split(".").pop())==null?void 0:o.toLowerCase())||"",r=N[p],t=d==="dark"?T:$;return g.useEffect(()=>{(async()=>{try{m(!0),i(null);const f=await P(c);if(console.log(`Loading code for design: ${c}, file: ${s}`),console.log("Code examples result:",f),!f)throw new Error(`No code examples found for design: ${c}`);console.log("Available code examples:",Object.keys(f));const j=f[s];if(j&&j.code)console.log("Found code example by filename:",s),l(j.code);else throw console.log("Code file not found:",s),console.log("Available files:",Object.keys(f)),new Error(`Code file not found: ${s}`)}catch(f){console.error(`Failed to load code file: ${s}`,f),i(`Failed to load ${s}`)}finally{m(!1)}})()},[s,c]),h?e.jsx("div",{className:"my-6 p-6 border border-border rounded-lg bg-muted/20",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Loading ",s,"..."]})]})}):n?e.jsxs("div",{className:"my-6 p-4 border border-destructive/20 rounded-lg bg-destructive/5",children:[e.jsx("h4",{className:"text-destructive font-medium mb-2",children:"Code Loading Error"}),e.jsxs("p",{className:"text-destructive text-sm",children:["Failed to load: ",e.jsx("code",{className:"bg-destructive/10 px-1 rounded",children:s})]}),e.jsxs("p",{className:"text-muted-foreground text-xs mt-1",children:["Expected path: ",e.jsxs("code",{className:"bg-muted px-1 rounded",children:["/src/content/system-design/code/",c,"/",s]})]})]}):e.jsxs("div",{className:"my-6",children:[(_||u)&&e.jsxs("div",{className:"mb-3",children:[_&&e.jsx("h4",{className:"text-lg font-medium text-foreground mb-1",children:_}),u&&e.jsx("p",{className:"text-sm text-muted-foreground",children:u})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"flex items-center justify-between bg-muted/50 px-4 py-2 rounded-t-lg border border-b-0 border-border",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[r&&e.jsx("img",{src:`/cracking-interview/assets/img/lang/${p}.svg`,alt:r.name,className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-mono text-foreground",children:s}),r&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",r.name,")"]})]})}),e.jsx("div",{className:"border border-border rounded-b-lg overflow-hidden",children:e.jsx(C,{language:(r==null?void 0:r.extension)||"text",style:t,customStyle:{margin:0,padding:"1.5rem",fontSize:"0.875rem",lineHeight:"1.5",borderRadius:0},showLineNumbers:!0,codeTagProps:{className:"text-sm"},children:x})})]})]})}function k({files:s,design:c,title:_,description:u}){var t;const[x,l]=g.useState([]),[h,m]=g.useState(""),[n,i]=g.useState(!0),{theme:d}=D(),p=d==="dark"?T:$;if(g.useEffect(()=>{(async()=>{var f,j;i(!0);const v=[];try{const y=await P(c);if(!y)throw new Error(`No code examples found for design: ${c}`);for(const b of s){const E=((f=b.split(".").pop())==null?void 0:f.toLowerCase())||"",L=N[E],O=y[b];O?v.push({filename:b,code:O.code,language:(L==null?void 0:L.name)||E.toUpperCase(),extension:E,error:void 0}):v.push({filename:b,code:"",language:E.toUpperCase(),extension:E,error:`Failed to load ${b}`})}}catch(y){console.error("Failed to load code examples:",y);for(const b of s){const E=((j=b.split(".").pop())==null?void 0:j.toLowerCase())||"";v.push({filename:b,code:"",language:E.toUpperCase(),extension:E,error:`Failed to load ${b}`})}}l(v),v.length>0&&m(v[0].filename),i(!1)})()},[s,c]),n)return e.jsx("div",{className:"my-6 p-6 border border-border rounded-lg bg-muted/20",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Loading code files..."})]})});const r=x.find(o=>o.filename===h);return e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"tabs mb-2 tabs-boxed bg-primary/50 p-1.5 gap-1 border border-base-300 shadow-sm rounded-lg",children:x.map(o=>e.jsxs("button",{role:"tab",onClick:()=>m(o.filename),className:`tab rounded-lg gap-2 transition-all duration-200 relative ${h===o.filename?"tab-active bg-primary text-primary-foreground shadow-lg":"text-foreground shadow-sm hover:text-foreground hover:bg-muted/50 hover:shadow-md"}`,children:[N[o.extension]&&e.jsx("img",{src:`/cracking-interview/assets/img/lang/${o.extension}.svg`,alt:o.language,className:`w-4 h-4 transition-all duration-200 ${h===o.filename?"drop-shadow-sm brightness-110":"opacity-100"}`}),e.jsx("span",{className:"capitalize transition-all duration-200",children:o.language}),o.error&&e.jsx("span",{className:"w-2 h-2 bg-destructive rounded-full ml-1",title:"Failed to load"})]},o.filename))}),r&&e.jsx("div",{className:"border border-base-300 rounded-b-lg overflow-hidden shadow-sm",children:r.error?e.jsxs("div",{className:"p-4 bg-destructive/5 text-destructive",children:[e.jsx("p",{className:"font-medium",children:"Error loading file"}),e.jsx("p",{className:"text-sm",children:r.error})]}):e.jsx(C,{language:((t=N[r.extension])==null?void 0:t.extension)||"text",style:p,customStyle:{margin:0,padding:"1.5rem",fontSize:"0.875rem",lineHeight:"1.5",borderRadius:"0.5rem"},showLineNumbers:!0,codeTagProps:{className:"text-sm"},children:r.code})})]})}function U({content:s}){const[c,_]=g.useState(""),[u,x]=g.useState([]);g.useEffect(()=>{(()=>{let n=s;const i=[];let d=0;n=n.replace(/<SystemDesignImage\s+([^>]+)\/?>(?:<\/SystemDesignImage>)?/g,(p,r)=>{const t=l(r),o=e.jsx(S,{src:t.src||"",alt:t.alt||"",caption:t.caption,design:t.design||""},`img-${d}`);return i.push(o),`__COMPONENT_${d++}__`}),n=n.replace(/<SystemDesignCode\s+([^>]+)\/?>(?:<\/SystemDesignCode>)?/g,(p,r)=>{const t=l(r),o=e.jsx(R,{file:t.file||"",design:t.design||"",title:t.title,description:t.description},`code-${d}`);return i.push(o),`__COMPONENT_${d++}__`}),n=n.replace(/<SystemDesignCodeTabs\s+([^>]+)\/?>(?:<\/SystemDesignCodeTabs>)?/g,(p,r)=>{const t=l(r);let o=[];try{t.files&&(o=JSON.parse(t.files.replace(/'/g,'"')))}catch{console.error("Failed to parse files array:",t.files)}const v=e.jsx(k,{files:o,design:t.design||"",title:t.title,description:t.description},`tabs-${d}`);return i.push(v),`__COMPONENT_${d++}__`}),_(n),x(i)})()},[s]);const l=m=>{const n={},i=/(\w+)=(?:"([^"]*)"|'([^']*)'|{([^}]*)})/g;let d;for(;(d=i.exec(m))!==null;){const[,p,r,t,o]=d;n[p]=r||t||o||""}return n},h=m=>{const n=m.split(/(__COMPONENT_\d+__)/),i=[];for(let d=0;d<n.length;d++){const p=n[d],r=p.match(/^__COMPONENT_(\d+)__$/);if(r){const t=parseInt(r[1],10),o=u[t];o&&i.push(o)}else p.trim()&&i.push(e.jsx("div",{className:"mdx-content",children:e.jsx(A,{content:p})},`markdown-${d}`))}return i};return e.jsx("div",{className:"prose prose-slate dark:prose-invert max-w-none font-sans",children:h(c)})}export{U as SimpleMDXRenderer};
